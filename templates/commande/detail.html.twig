{#
  Logiciel de caisse pour restaurants
  Copyright (C) 2025 RevivalSoft
  
  Ce programme est un logiciel libre ; vous pouvez le redistribuer et/ou
  le modifier selon les termes de la Licence Publique G√©n√©rale GNU publi√©e
  par la Free Software Foundation Version 3.
  
  Ce programme est distribu√© dans l'espoir qu'il sera utile,
  mais SANS AUCUNE GARANTIE ; sans m√™me la garantie implicite de
  COMMERCIALISATION ou D‚ÄôAD√âQUATION √Ä UN BUT PARTICULIER. Voir la
  Licence Publique G√©n√©rale GNU pour plus de d√©tails.
  
  Vous devriez avoir re√ßu une copie de la Licence Publique G√©n√©rale GNU
  avec ce programme ; si ce n'est pas le cas, voir
  https://www.gnu.org/licenses/
#}
{% extends 'base_commandes.html.twig' %}

{% block title %}D√©tails de la commande
{% endblock %}

{% block body %}
	<div class="container mt-4">
		<h1>D√©tails de la Commande #{{ commande.id }}</h1>

		{% for label, messages in app.flashes %}
			{% for message in messages %}
				<div class="alert alert-{{ label }} alert-dismissible fade show" role="alert">
					{{ message }}
					<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
				</div>
			{% endfor %}
		{% endfor %}

		<p>
			<strong>Table :</strong>
			{{ commande.table.nom }}</p>
		<p>
			<strong>Date :</strong>
			{{ commande.date|date('d/m/Y H:i') }}</p>

		<h3>Produits</h3>
		<table class="table table-bordered table-striped table-responsive">
			<thead class="table-light">
				<tr>
					<th>Produit</th>
					<th>Quantit√©</th>
					<th>Prix unitaire TTC</th>
					<th>Total TTC</th>
				</tr>
			</thead>
			<tbody>
				{% set totalTTC = 0 %}
				{% for ligne in commande.lignes %}
					{% set prixTTC = ligne.prixHT * (1 + ligne.tauxTva / 100) %}
					{% set totalProduit = prixTTC * ligne.quantite %}
					{% set totalTTC = totalTTC + totalProduit %}
					<tr>
						<td>{{ ligne.libelleProduit }}</td>
						<td>{{ ligne.quantite }}</td>
						<td>‚Ç¨
							{{ prixTTC|number_format(2, ',', ' ') }}</td>
						<td>‚Ç¨
							{{ totalProduit|number_format(2, ',', ' ') }}</td>
					</tr>
				{% endfor %}
			</tbody>
			<tfoot>
				<tr>
					<th colspan="3" class="text-end">Total TTC</th>
					<th>‚Ç¨
						{{ totalTTC|number_format(2, ',', ' ') }}</th>
				</tr>
			</tfoot>
		</table>

		<a href="{{ path('app_commande_reimprimer', {id: commande.id}) }}" class="btn btn-success mt-3">
			üñ® R√©imprimer le ticket
		</a>
		<a href="{{ path('app_commandes') }}" class="btn btn-secondary mt-3">Retour √† la liste</a>
	</div>
{% endblock %}
